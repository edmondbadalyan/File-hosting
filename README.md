# File-hosting  
Безопасный сервис хостинга файлов с .NET WPF клиентом и надежным сервером, разработанный для эффективного управления, хранения и обмена файлами с акцентом на безопасность и производительность.

## Содержание  
* [Ключевые особенности](#ключевые-особенности)  
* [Архитектура](#архитектура)  
* [Начало работы](#начало-работы)  
  * [Настройка сервера](#настройка-сервера)  
  * [Настройка клиента](#настройка-клиента)  
* [Технологический стек](#технологический-стек)  
* [Лицензия](#лицензия)  

## Ключевые особенности  
- **Управление пользователями**: Безопасная регистрация, вход и аутентификация.  
- **Операции с файлами и папками**: Загрузка, скачивание, создание, перемещение и удаление.  
- **Иерархическая структура каталогов**: Организация файлов в вложенные папки.  
- **Контроль доступа**:  
    - Назначение файлов, папок или профилей пользователя публичными или приватными.  
    - Просмотр и скачивание публичных файлов других пользователей.  
- **Безопасная связь**: Сквозное шифрование через гибридную схему RSA и AES.  
- **Автоматическое удаление файлов**: Настройка автоматической очистки корзины через заданный период.  
- **Интерфейс клиента**:  
    - Функциональное WPF-приложение с темной и светлой темами.  
    - Индикаторы прогресса при передаче файлов в реальном времени.  
- **Производительность**: Использование Redis для кэширования данных (информация о пользователях, списки файлов).  

## Архитектура  
Система реализована по клиент-серверной архитектуре с контейнеризацией для удобства развёртывания.  

1.  **WPF-клиент**: Десктоп-приложение на .NET/WPF с графическим интерфейсом для работы с файлами. Обмен данными с сервером через кастомный TCP-протокол.  
2.  **Nginx**: Обратный прокси, перенаправляющий TCP-трафик с внешнего порта на серверный контейнер.  
3.  **TCP-сервер**: Бэкенд на .NET, обрабатывающий бизнес-логику, запросы и взаимодействие с БД/кэшем.  
4.  **Microsoft SQL Server**: Основная БД для хранения метаданных пользователей, информации о файлах и структуре каталогов.  
5.  **Redis**: In-memory хранилище для кэширования сессий, метаданных файлов и планирования фоновых задач (например, удаления файлов).  

## Начало работы  

### Настройка сервера  
Сервисы развёрнуты в Docker-контейнерах.  

**Предварительные требования:**  
*   Docker и Docker Compose  
*   .NET SDK (для применения миграций БД)  

**Шаги:**  
1.  Клонируйте репозиторий:  
    ```sh  
    git clone https://github.com/edmondbadalyan/File-hosting.git  
    cd File-hosting/File-hosting-server  
    ```  

2.  Соберите и запустите сервисы:  
    ```sh  
    docker-compose up --build -d  
    ```  
    Команда создаёт образы MSSQL, Redis, .NET-сервера и Nginx, затем запускает их в фоновом режиме.  

3.  **Применение миграций БД:**  
    При первом запуске или после изменений в схеме БД выполните:  
    ```sh  
    dotnet ef database update --connection "Data Source=localhost,1434;Initial Catalog=Hosting_TestDb;User Id=sa;Password=StrongPassword123!;TrustServerCertificate=True;Encrypt=False;"  
    ```  
    Подключение к SQL Server (порт `1434`) и применение миграций.  

Сервер будет доступен по адресу `localhost:8080`.  

### Настройка клиента  
WPF-приложение запускается через Visual Studio.  

**Предварительные требования:**  
*   Visual Studio 2022+  
*   Набор .NET 8 Desktop Development  

**Шаги:**  
1.  Откройте `HostingLib.sln` в корне репозитория.  
2.  Установите проект `Client` как стартовый.  
3.  **Настройка подключения:**  
    Измените `Client/Config/config.json`:  
    ```json  
    {"ip":"localhost","port":8080,"theme":"dark"}  
    ```  
4.  Соберите и запустите проект (F5).  

## Технологический стек  
- **Бэкенд**: .NET 8, C#, TCP, Entity Framework Core, NLog, BCrypt.Net  
- **Фронтенд (Клиент)**: .NET 8, C#, WPF, MVVM (Prism, Extended.Wpf.Toolkit)  
- **База данных**: Microsoft SQL Server  
- **Кэширование**: Redis  
- **Инфраструктура**: Docker, Docker Compose, Nginx  

## Лицензия  
Проект распространяется под лицензией Apache License 2.0. Подробности в файле [LICENSE.txt](LICENSE.txt).
